<mat-chip (click)="toggle()" (removed)="onRemoved()">
  <ng-container *ngIf="value; else emptyValue">
    <mat-icon matChipAvatar>check</mat-icon>
    {{ label }} ~= {{ value }}
  </ng-container>
  <ng-template #emptyValue>{{ label }}</ng-template>
  <div #trigger="cdkOverlayOrigin" class="hidden" cdkOverlayOrigin></div>
  <ng-template
    cdkConnectedOverlay
    cdkConnectedOverlayLockPosition
    cdkConnectedOverlayHasBackdrop
    cdkConnectedOverlayBackdropClass="cdk-overlay-transparent-backdrop"
    [cdkConnectedOverlayOrigin]="trigger"
    [cdkConnectedOverlayOpen]="isOpen"
    (backdropClick)="toggle()"
  >
    <form class="flex" autocomplete="off" [formGroup]="formGroup" (ngSubmit)="save()">
      <div class="mat-menu-panel">
        <mat-form-field>
          <mat-label>{{ label }}</mat-label>
          <input matInput type="text" formControlName="value" />
        </mat-form-field>
        <button mat-stroked-button type="submit" color="primary">Filter</button>
      </div>
    </form>
  </ng-template>
  <button *ngIf="value" matChipRemove>
    <mat-icon>cancel</mat-icon>
  </button>
</mat-chip>
